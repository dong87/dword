---
title: "Vignette of dword"
author: "Dong Leiming"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## create folders

```{r}
gen_dir()
```

## Mendeley setting

You'd better to set your Mendelely following this image.

![](../img/mendeley.png)

Mendelely will correct you files automatically.

## Transfer pdfs to plain txt

```{r}
filenames <- "D:/R/Mendeley_PDF/Nature Genetics/FILENAME.pdf"
pdf2text_path <- "PATH/pdftotext.exe" ## space in the path is not allowed
pdf_2_txt(filenames, pdf2text_path)
```

## build database

```{r}
db_sci <- list(dest = "PATH/Mendeley_PDF/", myfiles = NULL, sents = NULL) # build a empty list comprising 3 elements. Assign path of the files saved by mendeley 
db_sci$myfiles <- all_pdf("D:/R/Mendeley_PDF/") # save all the pdf file names in this element
db_sci$sents <- db_txt(dest = db_sci$dest) %>% db_sent # processing the txt transfered from pdf files and spliting into single sentences
db_sci$sents <- db_sci$sents %>% gsub("`", "'", .) %>% gsub(" {2,10}", " ", .) %>% gsub("\\[|\\]|#", "", .) # repalce some special char and usless content
save(db_sci, file = "./data/db_sci.rdata") # save database to local
```

## extract sentences /w 3 examples

```{r}
### 尾部随机
word <- "SEM"; nf <- dsents(words = paste0("\\b", word, "\\w*"), sents = db_sci$sents, output = word, rm_pattern = "")
### 词尾相同+替换
word <- "(W|w)ood density"; nf <- dsents(words = paste0("\\w*", word), sents = db_sci$sents, output = "wood density", 
                                  rm_pattern = word)
### 邻接词随机+替换
word <- "as described in"; nf <- dsents(words = paste0(word, " \\w*ed"), sents = db_sci$sents, output = word, 
  rm_pattern = paste0(word, " "))
```

## extract word

```{r}
txts <- dwords(db_sci$sents,"outname")
```

## word frequency

```{r}
word_freq(db_sci$sents, filepath = "PATH/word_freq.csv")
```

